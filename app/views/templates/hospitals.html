<style>
    a{
        padding: 2px 10px;
    }
    a:hover{
        cursor: pointer;
    }
</style>
<div class="table-operation">
	<h3>医院列表</h3>
	<div>
	  <button type="button" class="btn btn-default">新增医院</button>
	  <button type="button" class="btn btn-default">导出</button>
    <button style="float: right;width: 5%;" ng-click="search()" class="btn btn-default">搜索</button>
    <input style="width: 13%;float: right;margin-left: 5px;margin-right: 5px;" type="text" ng-model="q" class="form-control" id="hos_q" placeholder="名称 、拼音">
    <select style="width: 6%;float: right;" ng-change="search()" ng-model="city_id" class="form-control">
      <option value="">全部</option>
      <option ng-repeat="city in cities" value={{city.id}}>{{city.name}}</option>
    </select>
	</div>

</div>
<table class="table table-bordered table-hover">
  	<tr style="text-align: center">
  	  <td>#</td>
  	  <td>医院名称</td>
  	  <td>城市</td>
  	  <td>分流医院</td>
  	  <td>详情</td>
      <td>检查项目/检验项目</td>
  	</tr>
  	<tr ng-repeat="hospital in self.hospitals" style="text-align: center;">
  		<td>{{hospital.id}}</td>
  		<td>{{hospital.name}}</td>
  		<td>{{hospital.city_zh}}</td>
  		<td>{{hospital.bridgings.join(", ")}}</td>
  		<td>
				<a class="btn btn-info btn-xs color_box" ng-click="open_detail(hospital)">详情</a>
				<a class="btn btn-success btn-xs color_box" ng-click="open_assistant(hospital)">合作人员</a>
			</td>
      <td><button type="button" class="btn btn-default" ng-click="open_hospital_project('lg',hospital.id)">查看详情</button></td>
  	</tr>
  </tbody>
</table>
<div class='pagination'>
  <uib-pagination style="margin-left: 10px;margin-top: -20px;" first-text="首页" last-text="尾页" previous-text="上一页" next-text="下一页" ng-change="pageChanged()" items-per-page=20 total-items="total_count" ng-model="current_page" max-size="maxSize" class="pagination-sm" boundary-links="true" rotate="false"></uib-pagination>
  <div style="float: right;position: relative;top: -20px;">
    跳转到第<input style="width: 40px;" id="go_page" type="text"></input>页
    <button type="button" class="btn btn-default" ng-click="setPage()">确定</button>
  </div>
</div>

<!-- map dialog -->
<script type="text/ng-template" id="hospital_detail.html">
  <div class="modal-header"  align="center">
      <h4 class="modal-title">{{hospital.name}}</h4>
  </div>
  <div class="modal-body">
    <div class="row">
			<div class="col-md-4">
				<label for="hos_address">地址</label>
		    <input type="text" ng-model="hospital.address" class="form-control" id='hos_address'>
		    <label for="hos_lnglat">坐标</label>
		    <input type="text" ng-model="lnglat" class="form-control"  id='hos_lnglat'>
		    <label for="hos_bus_line">行车路线</label>
		    <input type="text" ng-model="hospital.bus_line" class="form-control"  id='hos_bus_line'>
		    <label for="created_at">创建时间</label>
		    <input type="text" value="{{hospital.created_at | date:'yyyy-MM-dd HH:mm:ss'}}" class="form-control"  id='hos_created_at' disabled>
				<label for="hos_remark">备注</label>
		    <input type="text" ng-model="hospital.remark" class="form-control"  id='hos_remark'>
		    <label for="hos_intro">介绍</label>
		    <textarea rows=4 class="form-control"  id='hos_intro'>{{hospital.intro}}</textarea>
				<div>
					<button style="margin: 10px;" class="btn btn-warning" type="button" ng-click="cancel()">取消</button>
		    	<button style="float: left;margin-top: 10px;" ng-click="save(body)"class="btn btn-primary">确定</button>
				</div>
			</div>
			<div class="col-md-8">
				<img ng-src="{{map_src}}" alt='map'/>
			</div>
    </div>
  </div>
</script>

<script type="text/ng-template" id="assistants_detail.html">
  <div class="modal-header"  align="center">
      <h4 class="modal-title">{{hospital.name}}-合作人员</h4>
  </div>
  <div class="modal-body">
			<table class="table table-bordered table-hover">
				<tr>
					<th>#</th>
					<th>姓名</th>
					<th>手机</th>
					<th>地址</th>
					<th>是否接收短信</th>
					<th>创建时间</th>
					<th>备注</th>
					<th>操作</th>
				</tr>
        <tr ng-show="hospital.hospital_assistants.length==0">
          <td colspan="8">(没有相关合作人员记录)</td>
        </tr>
				<tr ng-repeat="assistant in hospital.hospital_assistants" style="text-align: center;">
					<td>{{assistant.id}}</td>
					<td>
						<a uib-popover-template="dynamicPopover.templateUrl" ng-style="{color:'black'}" popover-title="{{dynamicPopover.title}}" popover-trigger="outsideClick" ng-bind="assistant.name || '点击设置'" ng-click="select_click('name', assistant)"></a>
					</td>
					<td>
            <a uib-popover-template="dynamicPopover.templateUrl" ng-style="{color:'black'}" popover-title="{{dynamicPopover.title}}" popover-trigger="outsideClick" ng-bind="assistant.phone || '点击设置'" ng-click="select_click('phone', assistant)"></a>
          </td>
					<td>
            <a uib-popover-template="dynamicPopover.templateUrl" ng-style="{color:'black'}" popover-title="{{dynamicPopover.title}}" popover-trigger="outsideClick" ng-bind="assistant.address || '点击设置'" ng-click="select_click('address', assistant)"></a>
          </td>
					<td>
            <a uib-popover-template="dynamicPopover.templateUrl" ng-style="assistant.state=='issend'?{color:'green'}:{}" popover-title="{{dynamicPopover.title}}" popover-trigger="outsideClick" ng-bind="assistant.state=='issend'?'是':'否' " ng-click="select_click('state', assistant)"></a>
					</td>
					<td ng-style="{color:'black'}" >{{assistant.created_at | date:'yyyy-MM-dd HH:mm:ss'}}</td>
					<td>
            <a uib-popover-template="dynamicPopover.templateUrl" ng-style="{color:'black'}" popover-title="{{dynamicPopover.title}}" popover-trigger="outsideClick" ng-bind="assistant.remark || '点击设置'" ng-click="select_click('remark', assistant)"></a>
          </td>
					<td>
					  <a class="btn btn-danger btn-xs color_box" ng-click="delete_click(assistant)" ng-show="assistant.id" confirm="你确定要移除该合作人员吗？">删除</a>
					  <a class="btn btn-success btn-xs color_box" ng-show="!assistant.id" ng-click="add_click(assistant,hospital.id)">添加</a>
					</td>
				</tr>
			</table>
			<div>
        <button class="btn btn-warning" type="button" ng-click="cancel()">取消</button>
				<button class="btn btn-success" ng-click="add_assistant_row()">新增</button>
			</div>
    </div>
  </div>
</script>

<script type="text/ng-template" id="myPopInputTemplate.html">
    <div class="form-group form-inline">
        <input type="text" ng-model="modal_template.value" class="form-control">
        <button type="button" class="btn btn-success" ng-click="input_click()">确定</button>
    </div>
</script>

<script type="text/ng-template" id="myPopSelectTemplate.html">
    <div class="form-group">
        <select class="form-control" ng-model="modal_template.selected" ng-change="select_change()">
          <option value="issend">是</option>
          <option value="isnotsend">否</option>
        </select>
    </div>
</script>

<script type="text/ng-template" id="hospital_project.html">
  <div class="modal-header">
      <h3 class="modal-title">医院开展项目情况</h3>
  </div>
  <div class="modal-body">
    <table class="table table-bordered table-hover">
      <tr style="text-align: center">
      <td>项目名称</td>
      <td>状态</td>
      <td>医保情况</td>
    </tr>
    <tr ng-repeat="project in projects" style="text-align: center;">
      <td>{{project.project}}</td>
      <td><button style="font-size: 14px;" type="button" class="btn btn-link btn-xs" ng-click="change_status(project)">{{project.status_zh || "正常"}}</button></td>
      <td><button style="font-size: 14px;" type="button" class="btn btn-link btn-xs" ng-click="change_mbf(project)">{{project.mbf_zh || "无医保"}}</button></td>
    </tr>
    </table>
    <button style="margin: 10px;" class="btn btn-warning" type="button" ng-click="cancel()">关闭</button>
  </div>
</script>
